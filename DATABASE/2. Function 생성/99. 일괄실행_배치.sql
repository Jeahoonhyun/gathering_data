CREATE OR REPLACE FUNCTION fn_job_data_sm_mart_batch()
    	RETURNS TEXT
    AS $$
    
DECLARE	
	s_arr TEXT[] := array['20181025'
						,'20181026'
						,'20181027'
						,'20181028'
						,'20181029'
						,'20181030'
						,'20181031'
						,'20181101'
						,'20181102'
						,'20181103'
						,'20181104'
						,'20181105'
						,'20181106'
						,'20181107'
						,'20181108'
						,'20181109'
						,'20181110'
						,'20181111'
						,'20181112'
						,'20181113'
						,'20181114'
						,'20181115'
						,'20181116'
						,'20181117'
						,'20181118'
						,'20181119'
						,'20181120'
						,'20181121'
						,'20181122'
						,'20181123'
						,'20181124'
						,'20181125'
						,'20181126'
						,'20181127'
						,'20181128'
						,'20181129'
						,'20181130'
						,'20181201'
						,'20181202'
						,'20181203'
						,'20181204'
						,'20181205'
						,'20181206'
						,'20181207'
						,'20181208'
						,'20181209'
						,'20181210'
						,'20181211'
						,'20181212'
						,'20181213'
						,'20181214'
						,'20181215'
						,'20181216'
						,'20181217'
						,'20181218'
						,'20181219'
						,'20181220'
						,'20181221'
						,'20181222'
						,'20181223'
						,'20181224'
						,'20181225'
						,'20181226'
						,'20181227'
						,'20181228'
						,'20181229'
						,'20181230'
						,'20181231'
						,'20190101'
						,'20190102'];	

	s_fetch TEXT;	
	s_result TEXT;
BEGIN	
	
	FOREACH s_fetch IN ARRAY s_arr LOOP
        RAISE INFO '=> FN_JOB_DATA_SM_MART_NEW : %', s_fetch; 
        s_result := FN_JOB_DATA_SM_MART_NEW(s_fetch);
        --s_result := FN_JOB_DATA_SM_ALL_MART(s_fetch);
        --s_result := FN_JOB_DATA_PROFILE(s_fetch);
        RAISE INFO '=> Function Result : %', s_result; 
    END loop;

	RETURN 'OK';

EXCEPTION WHEN OTHERS THEN 
	RAISE NOTICE '% %', SQLERRM, SQLSTATE;
	RETURN SQLERRM;

END;